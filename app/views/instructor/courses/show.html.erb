<script>
	$(function() {
		$('.lessons').sortable({
			update: function( event, ui ) {
				$.ajax({
					type: 'PUT',
					url: ui.item.data('update-url'),
					dataType: 'json',
					data: { lesson: { row_order_position: ui.item.index() } }
				});
			}
		});
	});
</script>

<div class="enhance-box col-xs-10 col-xs-offset-1">
	<h1 class="text-center"><%= current_course.title %></h1><!-- /.text-center -->
	<%= image_tag current_course.image, class: 'img-responsive course-image' %>

	<%= link_to 'Preview as Student', course_path(current_course), class: 'btn btn-warning pull-right' %>

	<div class="clear"></div><!-- /.clear -->

	<div class="text-center">
		<%= link_to 'Add Section', new_instructor_course_section_path(current_course), class: 'btn btn-primary btn-lg new-section-btn' %>
	</div><!-- /.text-center -->

	<ul>
		<% current_course.sections.each do |section| %>
		<li>
			<%= section.title %>
			<%= link_to 'New Lesson', new_instructor_section_lesson_path(section), class: 'btn btn-primary btn-xs pull-right' %>
			<ul class="lessons">
				<% section.lessons.rank(:row_order).each do |lesson| %>
				<li data-update-url="<%= instructor_lesson_path(lesson) %>">
					<strong><%= lesson.title %></strong>
					- <%= lesson.subtitle %>
				</li>
				<% end %>
			</ul>
		</li>
		<% end %>
	</ul>
</div><!-- /.enhance-box col-xs-4 col-xs-offset-4 -->